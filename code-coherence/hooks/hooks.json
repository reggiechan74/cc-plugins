{
  "description": "Code coherence verification gates for high-stakes operations",
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "A Write or Edit operation is about to occur. Context: $ARGUMENTS\n\nCheck if the file_path matches high-stakes patterns (auth/**, payment/**, financial/**, migrations/**). If yes, respond with {\"ok\": false, \"reason\": \"HIGH-STAKES OPERATION: File matches critical pattern. Recommend running /coherence-check before proceeding.\"}. If no, respond with {\"ok\": true}.",
            "timeout": 30
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "A Bash command is about to execute. Context: $ARGUMENTS\n\nCheck if this is a publish command (npm publish, docker push to registry) or destructive operation (rm -rf, docker rm, git reset --hard, git push --force). Note: regular 'git push' and 'git commit' are normal development operations and should be allowed. If it is a publish or destructive command, respond with {\"ok\": false, \"reason\": \"DESTRUCTIVE/PUBLISH COMMAND: Please confirm.\"}. Otherwise respond with {\"ok\": true}.",
            "timeout": 30
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "File operation completed. Context: $ARGUMENTS\n\nIf this was a high-stakes file, briefly validate: 1) No obvious syntax errors, 2) No security issues (secrets in code, SQL injection patterns). If issues found, respond with {\"ok\": false, \"reason\": \"Issues detected: [describe issues]. Review recommended.\"}. If clean, respond with {\"ok\": true}.",
            "timeout": 60
          }
        ]
      }
    ]
  }
}
